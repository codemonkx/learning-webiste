<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Courses - LearnHub</title>
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="/" class="navbar-brand">⚡ LearnHub</a>
            <ul class="navbar-menu">
                <li><a href="/">Home</a></li>
                <li><a href="/courses.html">Courses</a></li>
                <li><a href="/search.html">Search</a></li>
            </ul>
            <div class="navbar-actions">
                <a href="/login.html" class="btn btn-secondary btn-small">Sign In</a>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <div class="hero" style="padding: 80px 24px; min-height: auto;">
        <div class="hero-content">
            <h1 style="font-size: clamp(2.5rem, 6vw, 4rem);">Explore All Courses</h1>
            <p style="font-size: 1.125rem;">Discover the perfect course to advance your career</p>
        </div>
    </div>

    <div class="container" style="margin-top: -40px;">
        <!-- Category Filters -->
        <div class="filters" id="categoryFilters">
            <button class="filter-btn active" data-category="all">All Courses</button>
            <button class="filter-btn" data-category="Programming">Programming</button>
            <button class="filter-btn" data-category="Design">Design</button>
            <button class="filter-btn" data-category="Business">Business</button>
            <button class="filter-btn" data-category="Marketing">Marketing</button>
            <button class="filter-btn" data-category="Data Science">Data Science</button>
        </div>

        <!-- Level Filters -->
        <div class="filters" style="margin-top: 12px;">
            <button class="filter-btn active" data-level="all">All Levels</button>
            <button class="filter-btn" data-level="Beginner">Beginner</button>
            <button class="filter-btn" data-level="Intermediate">Intermediate</button>
            <button class="filter-btn" data-level="Advanced">Advanced</button>
        </div>

        <!-- Course Count -->
        <div style="text-align: center; margin: 32px 0;">
            <p style="font-size: 1rem; color: var(--text-secondary);">
                Showing <span id="courseCount" style="font-weight: 700; color: var(--primary);">0</span> courses
            </p>
        </div>

        <!-- Courses Grid -->
        <div class="grid grid-3" id="coursesGrid" style="margin-bottom: 80px;">
            <div style="grid-column: 1 / -1; text-align: center; padding: 60px 0;">
                <div class="spinner" style="margin: 0 auto;"></div>
                <p style="margin-top: 20px; color: var(--text-secondary);">Loading courses...</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p class="footer-text">&copy; 2026 LearnHub. Empowering learners worldwide.</p>
        </div>
    </footer>

    <script src="/js/nav.js"></script>
    <script src="/js/main.js"></script>
    <script>
        let allCourses = [];
        let currentCategory = 'all';
        let currentLevel = 'all';

        const instructorNames = ['Sarah Johnson', 'Michael Chen', 'Emily Rodriguez', 'David Kim', 'Jessica Lee', 'Alex Thompson', 'Rachel Martinez', 'James Wilson'];

        async function loadCourses() {
            try {
                const response = await fetch('/api/courses');
                const data = await response.json();
                allCourses = data.courses;
                displayCourses(allCourses);
            } catch (error) {
                console.error('Error loading courses:', error);
                document.getElementById('coursesGrid').innerHTML =
                    '<p style="grid-column: 1 / -1; text-align: center; color: var(--text-secondary);">Unable to load courses.</p>';
            }
        }

        function displayCourses(courses) {
            const grid = document.getElementById('coursesGrid');
            document.getElementById('courseCount').textContent = courses.length;

            if (courses.length === 0) {
                grid.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: var(--text-secondary);">No courses found matching your filters.</p>';
                return;
            }

            grid.innerHTML = courses.map((course, index) => {
                const instructor = instructorNames[index % instructorNames.length];
                const rating = (4.3 + Math.random() * 0.7).toFixed(1);
                const students = Math.floor(Math.random() * 8000) + 500;
                const progress = course.enrolled ? Math.floor(Math.random() * 100) : null;
                const courseImage = getCourseImage(course.category, course.id);

                return `
                    <div class="course-card" onclick="window.location.href='/courses/${course.id}'">
                        <div class="course-image" style="background-image: url('${courseImage}'); background-size: cover; background-position: center;">
                            ${course.featured ? '<span class="badge badge-featured course-badge">Featured</span>' : ''}
                        </div>
                        <div class="course-body">
                            <div class="course-category">${course.category}</div>
                            <h3 class="course-title">${course.title}</h3>
                            <p class="course-description">${course.description.substring(0, 110)}...</p>
                            <div class="course-meta">
                                <span class="badge badge-primary">${course.level}</span>
                                <span class="badge badge-secondary">${students.toLocaleString()} students</span>
                                ${course.duration ? `<span class="badge badge-secondary">⏱️ ${course.duration}</span>` : ''}
                            </div>
                            ${progress !== null ? `
                                <div style="margin-top: 12px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 6px;">
                                        <span style="font-size: 0.875rem; color: var(--text-secondary);">Progress</span>
                                        <span style="font-size: 0.875rem; font-weight: 700; color: var(--primary);">${progress}%</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: ${progress}%"></div>
                                    </div>
                                </div>
                            ` : ''}
                            <div class="course-footer">
                                <div class="course-instructor">
                                    <div class="instructor-avatar">${course.instructor_name ? course.instructor_name.charAt(0) : instructor.charAt(0)}</div>
                                    <span class="instructor-name">${course.instructor_name || instructor}</span>
                                </div>
                                <div class="course-rating">★ ${course.rating || rating}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getCourseImage(category, courseId) {
            const imageMap = {
                'web': `https://images.unsplash.com/photo-1498050108023-c5249f4df085?w=800&h=450&fit=crop`,
                'data': `https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=800&h=450&fit=crop`,
                'security': `https://images.unsplash.com/photo-1550751827-4bd374c3f58b?w=800&h=450&fit=crop`,
                'database': `https://images.unsplash.com/photo-1544383835-bda2bc66a55d?w=800&h=450&fit=crop`,
                'cloud': `https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=800&h=450&fit=crop`,
                'Programming': `https://images.unsplash.com/photo-1461749280684-dccba630e2f6?w=800&h=450&fit=crop`,
                'Design': `https://images.unsplash.com/photo-1561070791-2526d30994b5?w=800&h=450&fit=crop`,
                'Business': `https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?w=800&h=450&fit=crop`,
                'Marketing': `https://images.unsplash.com/photo-1432888622747-4eb9a8f2c293?w=800&h=450&fit=crop`,
                'Data Science': `https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=800&h=450&fit=crop`,
                'Photography': `https://images.unsplash.com/photo-1452587925148-ce544e77e70d?w=800&h=450&fit=crop`,
                'Music': `https://images.unsplash.com/photo-1511379938547-c1f69419868d?w=800&h=450&fit=crop`
            };
            return imageMap[category] || `https://images.unsplash.com/photo-1516321318423-f06f85e504b3?w=800&h=450&fit=crop`;
        }

        function filterCourses() {
            let filtered = allCourses;

            if (currentCategory !== 'all') {
                filtered = filtered.filter(c => c.category === currentCategory);
            }

            if (currentLevel !== 'all') {
                filtered = filtered.filter(c => c.level === currentLevel);
            }

            displayCourses(filtered);
        }

        document.querySelectorAll('[data-category]').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('[data-category]').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentCategory = btn.dataset.category;
                filterCourses();
            });
        });

        document.querySelectorAll('[data-level]').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('[data-level]').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentLevel = btn.dataset.level;
                filterCourses();
            });
        });

        const urlParams = new URLSearchParams(window.location.search);
        const categoryParam = urlParams.get('category');
        if (categoryParam) {
            const btn = document.querySelector(`[data-category="${categoryParam}"]`);
            if (btn) btn.click();
        }

        loadCourses();
    </script>
</body>

</html>