<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Courses - LearnHub</title>
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="/" class="navbar-brand">‚ö° LearnHub</a>
            <ul class="navbar-menu">
                <li><a href="/">Home</a></li>
                <li><a href="/courses.html">Courses</a></li>
                <li><a href="/search.html">Search</a></li>
            </ul>
            <div class="navbar-actions">
                <a href="/login.html" class="btn btn-secondary btn-small">Sign In</a>
            </div>
        </div>
    </nav>

    <!-- Search Section -->
    <div class="container" style="padding-top: 80px;">
        <div style="text-align: center; margin-bottom: var(--space-2xl);">
            <h1 style="font-size: clamp(2.5rem, 6vw, 4rem); margin-bottom: var(--space-md);">Search Courses</h1>
            <p style="font-size: 1.125rem; color: var(--text-secondary);">Find the perfect course for your goals</p>
        </div>

        <!-- Search Bar -->
        <div class="search-container">
            <div class="search-bar">
                <span class="search-icon">üîç</span>
                <input type="text" id="searchInput" class="search-input" placeholder="Search for courses..."
                    autocomplete="off">
            </div>
        </div>

        <!-- Results Count -->
        <div style="text-align: center; margin: var(--space-xl) 0;">
            <p id="resultsCount" style="font-size: 0.9375rem; color: var(--text-secondary);"></p>
        </div>

        <!-- Results Grid -->
        <div class="grid grid-3" id="searchResults" style="margin-bottom: 80px;">
            <div style="grid-column: 1 / -1; text-align: center; padding: 60px 0;">
                <p style="color: var(--text-secondary); font-size: 1.125rem;">Start typing to search for courses...</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p class="footer-text">&copy; 2026 LearnHub. Empowering learners worldwide.</p>
        </div>
    </footer>

    <script src="/js/nav.js"></script>
    <script src="/js/main.js"></script>
    <script>
        const instructorNames = ['Sarah Johnson', 'Michael Chen', 'Emily Rodriguez', 'David Kim', 'Jessica Lee', 'Alex Thompson'];
        let searchTimeout;

        function getCategoryIcon(category) {
            const icons = {
                'Programming': 'üíª',
                'Design': 'üé®',
                'Business': 'üíº',
                'Marketing': 'üì±',
                'Data Science': 'üìä',
                'Photography': 'üì∑',
                'Music': 'üéµ'
            };
            return icons[category] || 'üìö';
        }

        async function performSearch(query) {
            if (!query || query.length < 2) {
                document.getElementById('searchResults').innerHTML =
                    '<div style="grid-column: 1 / -1; text-align: center; padding: 60px 0;"><p style="color: var(--text-secondary); font-size: 1.125rem;">Start typing to search for courses...</p></div>';
                document.getElementById('resultsCount').textContent = '';
                return;
            }

            document.getElementById('searchResults').innerHTML =
                '<div style="grid-column: 1 / -1; text-align: center; padding: 60px 0;"><div class="spinner" style="margin: 0 auto;"></div><p style="margin-top: 20px; color: var(--text-secondary);">Searching...</p></div>';

            try {
                const response = await fetch(`/api/search?q=${encodeURIComponent(query)}`);
                const data = await response.json();

                displayResults(data.results, query);
            } catch (error) {
                console.error('Search error:', error);
                document.getElementById('searchResults').innerHTML =
                    '<p style="grid-column: 1 / -1; text-align: center; color: var(--text-secondary);">Search failed. Please try again.</p>';
            }
        }

        function displayResults(results, query) {
            const grid = document.getElementById('searchResults');
            const count = document.getElementById('resultsCount');

            if (results.length === 0) {
                grid.innerHTML =
                    '<div style="grid-column: 1 / -1; text-align: center; padding: 60px 0;"><p style="color: var(--text-secondary); font-size: 1.125rem;">No courses found for "' + query + '"</p></div>';
                count.textContent = '';
                return;
            }

            count.textContent = `Found ${results.length} course${results.length !== 1 ? 's' : ''} for "${query}"`;

            grid.innerHTML = results.map((course, index) => {
                const instructor = instructorNames[index % instructorNames.length];
                const rating = (4.3 + Math.random() * 0.7).toFixed(1);
                const students = Math.floor(Math.random() * 8000) + 500;

                return `
                    <div class="course-card" onclick="window.location.href='/courses/${course.id}'">
                        <div class="course-image">
                            ${getCategoryIcon(course.category)}
                            ${course.featured ? '<span class="badge badge-featured course-badge">Featured</span>' : ''}
                        </div>
                        <div class="course-body">
                            <div class="course-category">${course.category}</div>
                            <h3 class="course-title">${course.title}</h3>
                            <p class="course-description">${course.description.substring(0, 110)}...</p>
                            <div class="course-meta">
                                <span class="badge badge-primary">${course.level}</span>
                                <span class="badge badge-secondary">${students.toLocaleString()} students</span>
                            </div>
                            <div class="course-footer">
                                <div class="course-instructor">
                                    <div class="instructor-avatar">${instructor.charAt(0)}</div>
                                    <span class="instructor-name">${instructor}</span>
                                </div>
                                <div class="course-rating">‚òÖ ${rating}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        document.getElementById('searchInput').addEventListener('input', (e) => {
            clearTimeout(searchTimeout);
            const query = e.target.value.trim();

            searchTimeout = setTimeout(() => {
                performSearch(query);
            }, 300);
        });

        // Check for query parameter
        const urlParams = new URLSearchParams(window.location.search);
        const queryParam = urlParams.get('q');
        if (queryParam) {
            document.getElementById('searchInput').value = queryParam;
            performSearch(queryParam);
        }
    </script>
</body>

</html>